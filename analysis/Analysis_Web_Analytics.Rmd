---
title: "Analysis_Web_Analytic"
author: "Dawn Han"
date: "2026-01-03"
output: html_document

---

```{r global-options, include=FALSE}
knitr::opts_chunk$set(
  fig.width = 12,
  fig.height = 8,
  fig.path = "../figs/",
  echo = TRUE,
  warning = FALSE,
  message = FALSE
)
```

```{css echo = FALSE}
body {
  font-size: 16px;
}
```

# Executive Summary

#### Goal
Evaluate current website performance by examining engagement, bounce behavior, and conversion outcomes, and identify actionable UX improvement opportunities.

#### Data
Aggregated web analytics data including number of sessions, session duraion, page-level performance, referral sources, and affinity categories.

#### Key Findings
- Over 30% of sessions end within the first 10 seconds, but sessions exceeding ~3 minutes show disproportionately high engagement (more page views). 
- Conversion and bounce behaviors are highly polarized, suggesting distinct user journeys rather than uniformly poor UX. 
- Bounce rate varies substantially by landing page and traffic source, but not by affinity category.

#### UX Implications
- Early-session friction, content relevance, and expectation mismatch are the primary risks. 
- Improvements should prioritize landing page optimization (particularly for "say" and "finishing" pages) and referral alignment, rather than audience targeting.



#### Data Quality & Measurement Decisions
- Before analysis, several decisions were made to ensure clarity and analytical validity:
  
- Sessions with missing or invalid duration values were removed, as these likely reflect logging errors.

- For affinity analyses, metrics (bounce rate and number of sessions) were aggregated at the level 1 affinity group (the broadest category) to simplify visualization. Bounce rates were computed as session-weighted averages to prevent distortion from low-traffic pages, while the number of sessions was summed to reflect the total user engagement for each affinity group.

- All analyses were performed on the processed datasets.



# Step 1: Setup

### Libraries Loaded: gggplot2, dplyr
<details> <summary>Show code</summary>
```{r results = FALSE}
library(dplyr)
library(ggplot2)
library(corrplot)
library(interactions)

```
</details>

### Data Imported: Web analytics datsets
<details> <summary>Show code</summary>
```{r results = FALSE}

user_data <- read.csv("../data/processed_data/user_data_clean.csv")

engagement_data <- read.csv("../data/processed_data/engagement_data_clean.csv")

page_data <- read.csv("../data/processed_data/page_data_clean.csv")

referrer_data <- read.csv("../data/processed_data/referrer_data_clean.csv")

affinity_summarydata <- read.csv("../data/processed_data/affinity_summarydata_clean.csv")
```
</details> 

### Global Plot-Formatting: Applied consistent styling
<details> <summary>Show code</summary>
```{r plotformat, results = FALSE}

theme_ux <- theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 20),
    plot.subtitle = element_text(size = 18),
    axis.title = element_text(size = 15),
    axis.text  = element_text(size = 13),
    panel.grid.minor = element_blank()
  )
  
```
</details> 
<br> 
<br> 

# Step 2: Understanding Engagement Patterns
## Session Duration Overview

<details> <summary>Show code for data preparation </summary>
```{r }  


engagement_data <- engagement_data %>% 
  mutate(
    # Make Session Duration as an ordered factor for better visualization
    SessionDuration = factor(
      engagement_data$SessionDuration, 
      levels = c("0-10 seconds", 
                 "11-30 seconds", 
                 "31-60 seconds",
                 "61-180 seconds",
                 "181-600 seconds",
                 "601-1800 seconds",
                 "1801+ seconds"
                  ),
      labels = c("0-10 seconds",
                  "11-30 seconds", 
                  "31-60 seconds",
                  "1-3 minutes", 
                  "3-10 minutes",
                  "10-30 minutes",
                  "30+ minutes"
                  ),
      ordered = TRUE
      )
    )

# Determine a scaling factor so the line fits on the same plot
scale_factor <- max(engagement_data$Sessions)/
  max(engagement_data$AvgViewPerSess)

```
</details>
<details> <summary>Show code for the plot</summary>
```{r eval=FALSE}
ggplot(engagement_data, aes(x = SessionDuration)) +
  geom_bar(aes(y = Sessions),
           stat = "identity",
           fill = "skyblue3",
           alpha = 0.7) +
  geom_line(aes(y = AvgViewPerSess * scale_factor, group = 1),
            color = "red", size = 0.9, alpha = 0.8) +
  geom_point(aes(y = AvgViewPerSess * scale_factor),
             color = "red", size = 2) +
  geom_text(
    aes(y = AvgViewPerSess * scale_factor,
        label = round(AvgViewPerSess, 1)),
    vjust = -0.8, color = "red", size = 3, check_overlap = TRUE
  ) +
  scale_y_continuous(
    name = "Number of Sessions",
    sec.axis = sec_axis(~ . / scale_factor,
                        name = "Number of Page Viewed (per Session)")
  ) +
  scale_x_discrete(labels = function(x) gsub("seconds", "sec", x)) +
  labs(
    title = "Longer Sessions Drive Higher Engagement",
    subtitle = "Bar shows total number of sessions; red line shows average number of pages viewed per session",
    x = "Session Duration"
  ) +
  theme_ux +
  theme(
    axis.title.y.right = element_text(color = "red"),
    axis.text.y.right  = element_text(color = "red"),
    axis.title.y.left = element_text(color = "skyblue4"),
    axis.text.y.left  = element_text(color = "skyblue4")
  )
```
</details>

```{r echo=FALSE}
# Draw the plot
ggplot(engagement_data, aes(x = SessionDuration)) +
  geom_bar(aes(y = Sessions),
           stat = "identity",
           fill = "skyblue3",
           alpha = 0.7) +
  geom_line(aes(y = AvgViewPerSess * scale_factor, group = 1),
            color = "red", size = 0.9, alpha = 0.8) +
  geom_point(aes(y = AvgViewPerSess * scale_factor),
             color = "red", size = 2) +
  geom_text(
    aes(y = AvgViewPerSess * scale_factor,
        label = round(AvgViewPerSess, 1)),
    vjust = -0.8, color = "red", size = 3, check_overlap = TRUE
  ) +
  scale_y_continuous(
    name = "Number of Sessions",
    sec.axis = sec_axis(~ . / scale_factor,
                        name = "Number of Page Viewed (per Session)")
  ) +
  scale_x_discrete(labels = function(x) gsub("seconds", "sec", x)) +
  labs(
    title = "Longer Sessions Drive Higher Engagement",
    subtitle = "Bar shows total number of sessions; red line shows average number of pages viewed per session",
    x = "Session Duration"
  ) +
  theme_ux +
  theme(
    axis.title.y.right = element_text(color = "red"),
    axis.text.y.right  = element_text(color = "red"),
    axis.title.y.left = element_text(color = "skyblue4"),
    axis.text.y.left  = element_text(color = "skyblue4")
  )
```

#### Interpretation

* Over 30% of sessions end within 10 seconds, indicating a substantial early-exit segment. 
* Among sessions that persist beyond the initial drop-off, 10â€“30 minutes is the most common duration. 
* Once sessions lasted longer than 3 minutes, page views increase disproportionately. 
* This sugggest a threshold effect: users either disengage almost immediately or become highly engaged.

 
#### Insights

* The ~3-minute threshold could guide design of engagement metrics. 

* Friction and expectation mismatch in the first moments of the session are likely contributors of early exit, but further analyses of bounce rate are warranted for more accurate recommendations. 

#### Limitations
* Using the 3-minute threshold as engagement index needs further validation because page view might not be purely indicate of engagement, but instead, ineffective website usage. It will be valuable to examine whether greater page view leads to higher conversion rate. However, this can not be tested in the current data set.  

* Relatedly, the longer session may mean ineffective usage. To rule out this possibility, upcoming analysis show whether session duration predicts conversion.

</br>
</br>

### Relationship Between Session Duration and Conversion Rate
<details> <summary>Show code for data preparation </summary>
```{r }  
# change units from seconds to minutes 
user_data <- user_data %>%
  mutate(Avg.SessionDuration.minutes. = 
           `Avg.SessionDuration.seconds.`/60)
```
</details>

<details> <summary>Show code for plot </summary>
```{r eval=FALSE}
# Scatter plot
ggplot(user_data, 
       aes(x=`Avg.SessionDuration.minutes.`,
           y=GoalConversionRate)) +
  geom_point(color = 'skyblue3', alpha = 0.7) +
  scale_x_continuous(breaks=seq(0,100,by=10)) +
  labs(title = "Users with Longer Sessions Reach the Conversion Goal More Often", x = "Avg. Session Duration (minutes)", y = "Conversion Rate") +
  theme_ux
```
</details>

```{r echo=FALSE}
# Scatter plot
ggplot(user_data, 
       aes(x=`Avg.SessionDuration.minutes.`,
           y=GoalConversionRate)) +
  geom_point(color = 'skyblue3', alpha = 0.7) +
  scale_x_continuous(breaks=seq(0,100,by=10)) +
  labs(title = "Users with Longer Sessions Reach the Conversion Goal More Often", x = "Avg. Session Duration (minutes)", y = "Conversion Rate") +
  theme_ux
```

#### Interpretation
* Users with longer average session durations are substantially more likely to convert. 
* The strong positive association suggests that longer sessions generally reflect meaningful engagement rather than confusion or inefficient navigation.

#### Insight
* Session duration is a valid engagement signal in this context and can be used to diagnose early disengagement risk.

<br> 
<br> 

## Conversion Rate Distribution
<details>
<summary>Show code for the plot</summary>
```{r eval=FALSE}
# Histogram with counts on bars
ggplot(user_data, aes(x = `GoalConversionRate`)) +
  geom_histogram(binwidth = 0.1, 
                 fill = "skyblue3", alpha = 0.7) +
  scale_x_continuous(breaks=seq(0,1,by=0.1))+
  geom_text(
    stat = "bin", 
    binwidth = 0.1,
    aes(label = ..count..), 
    vjust = -0.5,
    color = "black"
  ) +
  labs(title = "Conversion Rate Distribution", x = "Conversion rate", y = "Number of Users") +
  theme_ux
```
</details>

```{r echo=FALSE}
# Histogram with counts on bars
ggplot(user_data, aes(x = `GoalConversionRate`)) +
  geom_histogram(binwidth = 0.1, 
                 fill = "skyblue3", alpha = 0.7) +
  scale_x_continuous(breaks=seq(0,1,by=0.1))+
  geom_text(
    stat = "bin", 
    binwidth = 0.1,
    aes(label = ..count..), 
    vjust = -0.5,
    color = "black"
  ) +
  labs(title = "Conversion Rate Distribution", x = "Conversion rate", y = "Number of Users") +
  theme_ux
```

```{r echo = FALSE}
ZeroConversionPercent = nrow(
  user_data[
    (user_data$GoalConversionRate)==0,]
    )/
    length(is.na(user_data$GoalConversionRate))*
    100

OneConversionPercent = nrow(
    user_data[
      (user_data$GoalConversionRate)==1,]
    )/
    length(is.na(user_data$GoalConversionRate))*
    100

```


#### Interpretation
* A large proportion of users (~`r round(ZeroConversionPercent,1)`%) never convert, while a meaningful consistently reaches the goal behavior (~`r round(OneConversionPercent,1)`) always conduct the goal behavior. 

* This polarized distribution mirrors engagement patterns, reinforcing the presence of distinct user trajectories.

</br>
</br>


### Which Metrics Matter for Conversion?
<details>
<summary>Show code for data preparation</summary>
```{r}
cor_mat <- cor(
  user_data %>%
    select(GoalConversionRate, Sessions, `Avg.SessionDuration.seconds.`, BounceRate)
)

# Rename variables for display
colnames(cor_mat) <- rownames(cor_mat) <- c(
  "Conversion Rate",
  "Session Count",
  "Session Duration",
  "Bounce Rate"
)
```
</details>

<details>
<summary>Show code for the plot</summary>
```{r eval=FALSE}
corrplot(cor_mat,
         tl.col = "black", 
         type = "upper",
         tl.srt = 45,            
         tl.cex = 0.9,
         number.cex = 0.8,
         addCoef.col = "grey20",
         mar = c(0, 0, 2, 0),
         title = "Correlation Between Engagement Metrics")

  
```
</details>

```{r echo=FALSE}
corrplot(cor_mat,
         tl.col = "black", 
         type = "upper",
         tl.srt = 45,            
         tl.cex = 0.9,
         number.cex = 0.8,
         addCoef.col = "grey20",
         mar = c(0, 0, 2, 0),
         title = "Correlation Between Engagement Metrics")
```

```{r}
cor_duration = cor_mat['Conversion Rate','Session Duration']
cor_bounce = cor_mat['Conversion Rate','Bounce Rate']
cor_session = cor_mat['Conversion Rate','Session Count']
```

#### Interpretation
* Conversion is strongly associated with session duration (r = `r round(cor_duration, 2)`).
* Bounce rate also shows a meaningful negative relationship with conversion (r= `r round(cor_bounce, 2)`.
* Number of sessions exhibits a weaker association (r = `r round(cor_session, 2)`).

#### Insight
* Combined with the earlier analysis that most sessions lasted less than 10 seconds, biggest opportunity for improving conversion behavior likely lies in improving the early session experience (which can lower bounce rate and lengthen session duration). Thus, the rest of the report focuses on early disengagement metrics, bounce rate.


</br>
</br>

# Step 3. Diagnosing Early Disengagement

## Bounce Behavior Overview
<details>
<summary>Show code for the plot</summary>
```{r eval=FALSE}
# Histogram with counts on bars
ggplot(user_data, aes(x = `BounceRate`)) +
  geom_histogram(binwidth = 0.1,  fill = "skyblue3", alpha = 0.7) +
  scale_x_continuous(breaks=seq(0,1,by=0.1))+
  geom_text(
    stat = "bin", 
    binwidth = 0.1,
    aes(label = ..count..), 
    vjust = -0.5,
    color = "black"
  ) +
  labs(title = "Bounce Rate Distribution", x = "Bounce rate", y = "Number of Users") +
  theme_ux
```
</details>

```{r echo=FALSE}
# Histogram with counts on bars
ggplot(user_data, aes(x = `BounceRate`)) +
  geom_histogram(binwidth = 0.1,  fill = "skyblue3", alpha = 0.7) +
  scale_x_continuous(breaks=seq(0,1,by=0.1))+
  geom_text(
    stat = "bin", 
    binwidth = 0.1,
    aes(label = ..count..), 
    vjust = -0.5,
    color = "black"
  ) +
  labs(title = "Bounce Rate Distribution", x = "Bounce rate", y = "Number of Users") +
  theme_ux
```

#### Interpretation
* The bounce rate distribution is highly polarized: most users (~65.8%) never bounce, yet a notable minority (~14.8%) always bounce. 
* No bouncing of majority users do not suggest poor overall UX.
* Instead, it suggests that early experience that may be segmented by:
<ol>
  <li>quality or relevance issues on specific landing pages</li>
  <li>mismatched traffic sources bringing in less interested or less relevant visitors</li>
  <li>differences in user segments (e.g., interest). </li>
</ol>

#### Recommendations
* Further analysis should focus on landing pages, referral sources, and affinity group for high bounce rates.

<br> 
<br> 

# Step 3. Testing The Hypothesis
## Hypothesis 1: Landing Page Issues
<details>
<summary>Show code for data preparation</summary>
```{r }
# Calculate cumulative x positions for variable-width columns (Marimekko)
page_data <- page_data %>%
  mutate(
    Width = `Pageviews` / sum(`Pageviews`),        # width proportional to pageviews
    xmin = lag(cumsum(Width), default = 0),        
    xmax = cumsum(Width)                          
  )

# Max values for scaling secondary axis
max_bounce <- max(page_data$`BounceRate`)
max_load   <- max(page_data$`Avg.PageLoadTime.sec.`)

```
</details>

<details>
<summary>Show code for the plot</summary>
```{r eval=FALSE}
ggplot(page_data) +
  geom_rect(aes(xmin = xmin, xmax = xmax,
                ymin = 0, ymax = BounceRate),
            fill = "skyblue3", color = "skyblue4", alpha = 0.7) +
  geom_line(aes(x = (xmin + xmax)/2,
                y = Avg.PageLoadTime.sec. * max_bounce / max_load),
            color = "red", size = 0.9, alpha = 0.8) +
  scale_y_continuous(
    name = "Bounce Rate",
    sec.axis = sec_axis(~ . * max_load / max_bounce,
                        name = "Avg. Page Load Time (sec)")
  ) +
  scale_x_continuous(
    breaks = (page_data$xmin + page_data$xmax)/2,
    labels = page_data$Page
  ) +
  labs(
    title = "Bounce Rate Varies Sharply by Page, Independent of Load Time",
    subtitle = "Bar width reflects traffic volume; red line shows average load time",
    x = "Pages (width proportional to traffic)",
    y = "Bounce Rate"
  )+
  theme_ux +
  theme(axis.text.x = element_text(angle = 90, hjust = 1,
                                   vjust = ifelse(seq_along(page_data$Page) %% 2 == 0, 1, 0.3)),
        axis.title.y.right = element_text(color = "red"),
        axis.text.y.right  = element_text(color = "red"))
```
</details>

```{r echo=FALSE}
ggplot(page_data) +
  geom_rect(aes(xmin = xmin, xmax = xmax,
                ymin = 0, ymax = BounceRate),
            fill = "skyblue3", color = "skyblue4", alpha = 0.7) +
  geom_line(aes(x = (xmin + xmax)/2,
                y = Avg.PageLoadTime.sec. * max_bounce / max_load),
            color = "red", size = 0.9, alpha = 0.8) +
  scale_y_continuous(
    name = "Bounce Rate",
    sec.axis = sec_axis(~ . * max_load / max_bounce,
                        name = "Avg. Page Load Time (sec)")
  ) +
  scale_x_continuous(
    breaks = (page_data$xmin + page_data$xmax)/2,
    labels = page_data$Page
  ) +
  labs(
    title = "Bounce Rate Varies Sharply by Page, Independent of Load Time",
    subtitle = "Bar width reflects traffic volume; red line shows average load time",
    x = "Pages (width proportional to traffic)",
    y = "Bounce Rate"
  )+
  theme_ux +
  theme(axis.text.x = element_text(angle = 90, hjust = 1,
                                   vjust = ifelse(seq_along(page_data$Page) %% 2 == 0, 1, 0.3)),
        axis.title.y.right = element_text(color = "red"),
        axis.text.y.right  = element_text(color = "red"))
```


#### Interpretation
* Bounce rates vary substantially by page, but are not strongly associated with page load time. 
* This suggests content relevance, expectation mismatch, or friction (other than slow loading time) as the primary issues.

#### Recommendations
* Conduct qualitative evaluation (e.g., usability testing) on high-traffic, high-bounce landing pages (i.e., "Say" and "Finishing" pages.)

<br> 
<br> 

# Hypothesis 2: Referral Source Mismatch
<details>
<summary>Show code for data preparation</summary>
```{r}
# Calculate cumulative x positions for variable-width columns (Marimekko)
referrer_data <- referrer_data %>%
  mutate(
    Width = `Sessions` / sum(`Sessions`),
    xmin = lag(cumsum(Width), default = 0),
    xmax = cumsum(Width)
  )
```
</details>

<details>
<summary>Show code for the plot</summary>
```{r eval=FALSE}
# Create the plot
ggplot(referrer_data) +
  geom_rect(aes(xmin = xmin, xmax = xmax,
                ymin = 0, ymax = BounceRate),
            fill = "skyblue3", color = "skyblue4", alpha = 0.7) +
  scale_x_continuous(
    breaks = (referrer_data$xmin + referrer_data$xmax)/2,
    labels = referrer_data$Source
  ) +
  labs(
    title = "Bounce Rates Differ Substantially Across Traffic Sources",
    subtitle = "Bar width reflects session volume",
    x = "Source (width proportional to sessions)",
    y = "Bounce Rate"
  ) +
  theme_ux +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```
</details>

```{r echo = FALSE}
# Create the plot
ggplot(referrer_data) +
  geom_rect(aes(xmin = xmin, xmax = xmax,
                ymin = 0, ymax = BounceRate),
            fill = "skyblue3", color = "skyblue4", alpha = 0.7) +
  scale_x_continuous(
    breaks = (referrer_data$xmin + referrer_data$xmax)/2,
    labels = referrer_data$Source
  ) +
  labs(
    title = "Bounce Rates Differ Substantially Across Traffic Sources",
    subtitle = "Bar width reflects session volume",
    x = "Source (width proportional to sessions)",
    y = "Bounce Rate"
  ) +
  theme_ux +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

#### Interpretation
* Significant traffic comes from site.com, with higher bounce rate than other sources. 
* Visitors from site.com may have misaligned expectations.

#### Recommendations
* Review referral messaging and acquisition strategies to better align incoming traffic with on-site content.
* May consider reallocating acquisition efforts toward higher-engagement sources (e.g., Facebook, Outlook).

<br> 
<br> 

# Hypothesis 3: Varied User Experience Across Affinity Categories
<details>
<summary>Show code for data preparation</summary>
```{r }
# Show Bounce rate by a broad affinity category

# Calculate cumulative x positions for variable-width columns (Marimekko)
affinity_summarydata<- affinity_summarydata %>%
  mutate(
    Width = `total_sessions` / sum(`total_sessions`),
    xmin = lag(cumsum(Width), default = 0),
    xmax = cumsum(Width)
  )
```
</details>

<details>
<summary>Show code for the plot</summary>
```{r eval=FALSE}
ggplot(affinity_summarydata) +
  geom_rect(aes(xmin = xmin, xmax = xmax,
                ymin = 0, ymax = `bounce_rate`),
            fill = "skyblue3", color = "skyblue4", alpha = 0.7) +
  scale_x_continuous(
    breaks = (affinity_summarydata$xmin + affinity_summarydata$xmax)/2,
    labels = affinity_summarydata$AffinityLevel_1 ) +
  labs(title = "Bounce Rates Show Limited Variation Across Affinity Groups", 
       subtitle = "Bar width reflects session volume",
       x = "Affinity",
       y = "Bounce Rate")+
  theme_ux +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```
</details>

```{r echo=FALSE}
ggplot(affinity_summarydata) +
  geom_rect(aes(xmin = xmin, xmax = xmax,
                ymin = 0, ymax = `bounce_rate`),
            fill = "skyblue3", color = "skyblue4", alpha = 0.7) +
  scale_x_continuous(
    breaks = (affinity_summarydata$xmin + affinity_summarydata$xmax)/2,
    labels = affinity_summarydata$AffinityLevel_1 ) +
  labs(title = "Bounce Rates Show Limited Variation Across Affinity Groups", 
       subtitle = "Bar width reflects session volume",
       x = "Affinity",
       y = "Bounce Rate")+
  theme_ux +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Interpretation
* Bounce rates are consistent across affinity groups.
* This suggests disengagement is not driven primarily by audience segmentation.

#### Recommendations
Investigate interaction between landing page and referral source to test whether some pages are problematic particularly for specific traffic sources.

<br>
<br>

# Conclusion

* Key UX risks stem from early-session friction, content relevance, and expectation mismatch.

* Actionable improvements include refining high-bounce landing pages, aligning referral sources.

* Session duration, particularly the ~3-minute threshold, could provide a meaningful benchmark for defining engaged users and evaluating UX interventions. Yet, this warrants further investigation.
